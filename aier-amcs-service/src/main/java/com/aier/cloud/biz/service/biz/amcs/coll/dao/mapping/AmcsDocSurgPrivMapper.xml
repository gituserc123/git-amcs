<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aier.cloud.biz.service.biz.amcs.coll.dao.AmcsDocSurgPrivMapper">
  <resultMap id="BaseResultMap" type="com.aier.cloud.biz.service.biz.amcs.coll.entity.AmcsDocSurgPriv">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Jan 23 16:34:04 CST 2018.
    --> 
    <id column="ID" jdbcType="DECIMAL" property="id" />
	<result column="DOCTOR_ID" jdbcType="DECIMAL" property="doctorId" />
	<result column="DOCTOR_NAME" jdbcType="VARCHAR" property="doctorName" />
	<result column="SURG_TYPE_CODE" jdbcType="DECIMAL" property="surgTypeCode" />
	<result column="SURG_TYPE_NAME" jdbcType="VARCHAR" property="surgTypeName" />
	<result column="HOSP_ID" jdbcType="DECIMAL" property="hospId" />
	<result column="HOSP_NAME" jdbcType="VARCHAR" property="hospName" />
	<result column="DEPT_ID" jdbcType="DECIMAL" property="deptId" />
	<result column="DEPT_NAME" jdbcType="VARCHAR" property="deptName" />
	<result column="PROVINCE_ID" jdbcType="DECIMAL" property="provinceId" />
	<result column="PROVINCE_NAME" jdbcType="VARCHAR" property="provinceName" />
	<result column="USING_SIGN" jdbcType="DECIMAL" property="usingSign" />
	<result column="MODIFER" jdbcType="DECIMAL" property="modifer" />
	<result column="MODIFY_DATE" jdbcType="TIMESTAMP" property="modifyDate" />
  </resultMap>
  <sql id="BaseColumnList">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Jan 23 16:34:04 CST 2018.
    -->
	ID, DOCTOR_ID, DOCTOR_NAME, SURG_TYPE_CODE, SURG_TYPE_NAME, HOSP_ID, HOSP_NAME, PROVINCE_ID, 	
	PROVINCE_NAME, USING_SIGN, MODIFER, MODIFY_DATE, DEPT_ID, DEPT_NAME
  </sql>
  
  <select id="findCountByProv" resultType="Map">
    select count('x') as count, province_name, surg_type_name 
    from T_AMCS_DOC_SURG_PRIV t
   <include refid="sql_where" />
    group by province_name, surg_type_name
  </select>
  <select id="findListByDoctor" resultType="com.aier.cloud.biz.service.biz.amcs.coll.entity.AmcsDocSurgPriv">
  	select
	<include refid="BaseColumnList" />
	from T_AMCS_DOC_SURG_PRIV t
	<include refid="sql_where" />
	order by t.DOCTOR_NAME, t.MODIFY_DATE desc
  </select>
  <select id="findStaffIdByHosp" resultType="Long">
  	select DOCTOR_ID 
  	from T_AMCS_DOC_SURG_PRIV t
  	where t.HOSP_ID = #{hospId}
  	group by DOCTOR_ID
  </select>
  <sql id="sql_where">
		<trim prefix="WHERE" prefixOverrides="AND | OR">
			1 = 1
			<if test="cond.provId != null and cond.provId != '' ">
		    	and t.province_id = #{cond.provId}
		    </if>
		    <if test="cond.surgType != null and cond.surgType != '' ">
		    	and t.surg_type_code in 
		    	<foreach collection="cond.surgType.split(',')" index="index" item="item"
					separator="," open="(" close=")">
					#{item}
				</foreach>
		    </if>
		    
		    <if test="cond.doctorId != null and cond.doctorId != '' ">
		    	and t.doctor_id = #{cond.doctorId}
		    </if>
		    <if test="cond.hospId != null and cond.hospId != '' ">
		    	and t.hosp_id = #{cond.hospId}
		    </if>
		</trim>
		
   </sql>
</mapper>