<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aier.cloud.biz.service.biz.amcs.fin.dao.FinInsMonthMapper">
  <resultMap id="BaseResultMap" type="com.aier.cloud.biz.service.biz.amcs.fin.entity.FinInsMonth">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Jan 23 16:34:04 CST 2018.
    --> 
    <id column="ID" jdbcType="DECIMAL" property="id" />
	<result column="CREATOR" jdbcType="DECIMAL" property="creator" />
	<result column="CREATE_DATE" jdbcType="TIMESTAMP" property="createDate" />
	<result column="MODIFER" jdbcType="DECIMAL" property="modifer" />
	<result column="MODIFY_DATE" jdbcType="TIMESTAMP" property="modifyDate" />
	<result column="HOSP_ID" jdbcType="DECIMAL" property="hospId" />
	<result column="STATUS" jdbcType="DECIMAL" property="status" />
  </resultMap>
  <sql id="BaseColumnList">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Jan 23 16:34:04 CST 2018.
    -->
	CREATOR, CREATE_DATE, MODIFER, MODIFY_DATE, HOSP_ID, ID, 	
	STATUS 
  </sql>
	<sql id="sql_where">
		<trim prefix="WHERE" prefixOverrides="AND | OR">
			<if test="cond.hospId != null and cond.hospId>0">
				and t.HOSP_ID = #{cond.hospId}
			</if>
			<if test="cond.hospList != null and cond.hospList.size() > 0">
				and t.HOSP_ID in
				<foreach collection="cond.hospList" index="index" item="item"
						 separator="," open="(" close=")">
					#{item}
				</foreach>
			</if>
			<if test="cond.status!=null and cond.status.size() >0">
				and t.status in
				<foreach collection="cond.status" item="item" separator="," open="(" close=")">
					#{item}
				</foreach>
			</if>
		</trim>
	</sql>
	<select id="getList" resultType="Map">
		select * from T_FIN_INS_MONTH t
		<include refid="sql_where"/>
		order by t.CREATE_DATE desc
	</select>
	<delete id="deleteAdvance">
		delete from t_fin_ins_advance_total t where t.MONTH_ID=#{monthId}
	</delete>
	<delete id="deleteConsum">
		delete from t_fin_ins_consumables_info t where t.MONTH_ID=#{monthId}
	</delete>
	<delete id="deleteDipA">
		delete from t_fin_ins_dip_analysis t where t.MONTH_ID=#{monthId}
	</delete>
	<delete id="deleteDipP">
		delete from t_fin_ins_dip_pay t where t.MONTH_ID=#{monthId}
	</delete>
	<delete id="deleteDrgA">
		delete from t_fin_ins_drg_analysis t where t.MONTH_ID=#{monthId}
	</delete>
	<delete id="deleteDrgP">
		delete from t_fin_ins_drg_pay t where t.MONTH_ID=#{monthId}
	</delete>
	<delete id="deleteMain">
		delete from t_fin_ins_main t where t.MONTH_ID=#{monthId}
	</delete>
	<delete id="deletePerP">
		delete from t_fin_ins_pertime_pay t where t.MONTH_ID=#{monthId}
	</delete>
	<delete id="deleteProP">
		delete from t_fin_ins_project_pay t where t.MONTH_ID=#{monthId}
	</delete>
	<delete id="deleteSingle">
		delete from t_fin_ins_single_disease t where t.MONTH_ID=#{monthId}
	</delete>
	<delete id="deleteMonth">
		delete from t_fin_ins_month t where t.ID=#{monthId}
	</delete>
	<select id="unReport" resultType="Map">
		select distinct(t.Hosp_Id) from T_FIN_INS_MONTH t
		<trim prefix="WHERE" prefixOverrides="AND | OR">
		<if test="cond.hospList != null and cond.hospList.size() > 0">
			and t.HOSP_ID in
			<foreach collection="cond.hospList" index="index" item="item"
					 separator="," open="(" close=")">
				#{item}
			</foreach>
		</if>
		</trim>
		MINUS
		select distinct(t.Hosp_Id) from T_FIN_INS_MONTH t
		<trim prefix="WHERE" prefixOverrides="AND | OR">
			<if test="cond.hospList != null and cond.hospList.size() > 0">
				and t.HOSP_ID in
				<foreach collection="cond.hospList" index="index" item="item"
						 separator="," open="(" close=")">
					#{item}
				</foreach>
			</if>
			and t.create_date>TRUNC(SYSDATE, 'MONTH')
		</trim>
	</select>
	<select id="reporting" resultType="Map">
		select distinct(t.Hosp_Id) from T_FIN_INS_MONTH t
		<trim prefix="WHERE" prefixOverrides="AND | OR">
			<if test="cond.hospList != null and cond.hospList.size() > 0">
				and t.HOSP_ID in
				<foreach collection="cond.hospList" index="index" item="item"
						 separator="," open="(" close=")">
					#{item}
				</foreach>
			</if>
			and t.status=1 and t.create_date>TRUNC(SYSDATE, 'MONTH')
		</trim>
	</select>
	<select id="returnBack" resultType="Map">
		select distinct(t.Hosp_Id) from T_FIN_INS_MONTH t
		<trim prefix="WHERE" prefixOverrides="AND | OR">
			<if test="cond.hospList != null and cond.hospList.size() > 0">
				and t.HOSP_ID in
				<foreach collection="cond.hospList" index="index" item="item"
						 separator="," open="(" close=")">
					#{item}
				</foreach>
			</if>
			and t.status=9 and t.create_date>TRUNC(SYSDATE, 'MONTH')
		</trim>
	</select>
	<select id="noPrice" resultType="Map">
		select distinct(t.Hosp_Id) from T_FIN_INS_MONTH t
		<trim prefix="WHERE" prefixOverrides="AND | OR">
			<if test="cond.hospList != null and cond.hospList.size() > 0">
				and t.HOSP_ID in
				<foreach collection="cond.hospList" index="index" item="item"
						 separator="," open="(" close=")">
					#{item}
				</foreach>
			</if>
		</trim>
		MINUS
		select distinct(t.Hosp_Id) from T_FIN_INS_PRICE_POLICY t
		<trim prefix="WHERE" prefixOverrides="AND | OR">
			<if test="cond.hospList != null and cond.hospList.size() > 0">
				and t.HOSP_ID in
				<foreach collection="cond.hospList" index="index" item="item"
						 separator="," open="(" close=")">
					#{item}
				</foreach>
			</if>
			and t.create_date>TRUNC(SYSDATE, 'YEAR')
		</trim>
	</select>

	<select id="noDrgDip" resultType="Map">
		select distinct(t.Hosp_Id) from T_FIN_INS_MONTH t
		<trim prefix="WHERE" prefixOverrides="AND | OR">
			<if test="cond.hospList != null and cond.hospList.size() > 0">
				and t.HOSP_ID in
				<foreach collection="cond.hospList" index="index" item="item"
						 separator="," open="(" close=")">
					#{item}
				</foreach>
			</if>
		</trim>
		MINUS
		select distinct(t.Hosp_Id) from T_FIN_MA_MAIN t
		<trim prefix="WHERE" prefixOverrides="AND | OR">
			<if test="cond.hospList != null and cond.hospList.size() > 0">
				and t.HOSP_ID in
				<foreach collection="cond.hospList" index="index" item="item"
						 separator="," open="(" close=")">
					#{item}
				</foreach>
			</if>
			and t.ma_year||t.ma_quarter=#{quarter}
		</trim>
	</select>



</mapper>
