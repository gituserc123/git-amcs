<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aier.cloud.biz.service.biz.amcs.adverse.dao.AeExpertEventMapper">
  <resultMap id="BaseResultMap" type="com.aier.cloud.biz.service.biz.amcs.adverse.entity.AeExpertEvent">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Jan 23 16:34:04 CST 2018.
    --> 
    <id column="ID" jdbcType="DECIMAL" property="id" />
	<result column="MODIFY_DATE" jdbcType="TIMESTAMP" property="modifyDate" />
	<result column="MODIFER" jdbcType="DECIMAL" property="modifer" />
	<result column="USING_SIGN" jdbcType="DECIMAL" property="usingSign" />
	<result column="EXPERT_ID" jdbcType="DECIMAL" property="expertId" />
	<result column="EVENT_ID" jdbcType="DECIMAL" property="eventId" />
	<result column="IS_PROVINCE" jdbcType="DECIMAL" property="isProvince" />
  </resultMap>
  <sql id="BaseColumnList">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Jan 23 16:34:04 CST 2018.
    -->
	MODIFY_DATE, MODIFER, USING_SIGN, EXPERT_ID, EVENT_ID, ID, IS_PROVINCE
  </sql>
  
  
  <select id="findExpertDayCount" resultType="Integer">
	select count('x')
   	from t_ae_expert_event
 	where expert_id = #{expertId}
 	<if test="isProvince">
 		and is_province = 1
 	</if>
 	<if test="!isProvince">
 		and ( is_province = 0 or is_province is null )
 	</if>
   		and modify_date between
       	TO_DATE(TO_CHAR(SYSDATE - 1, 'YYYY-MM-DD') || ' 17:00:00','YYYY-MM-DD HH24:MI:SS') and
       	TO_DATE(TO_CHAR(SYSDATE, 'YYYY-MM-DD') || ' 17:00:00', 'YYYY-MM-DD HH24:MI:SS')
  </select>
  <select id="findListByEvent"  resultType="Map">
  	select e.id, e.staff_id, e.staff_code, e.staff_name, e.group_value
	  from t_ae_expert_event t
	  left join t_ae_expert e
	    on t.expert_id = e.staff_id
	 where t.event_id = #{cond.eventId}
  	<if test="cond.isProvince">
  		and t.is_province = 1
  	</if>
  	<if test="!cond.isProvince">
  		and ( t.is_province = 0 or t.is_province is null )
	</if>
  </select>
</mapper>