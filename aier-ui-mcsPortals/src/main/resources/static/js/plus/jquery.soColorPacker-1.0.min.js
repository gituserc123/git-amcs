/*
 *	soColorPacker 1.0 
 *	made by bujichong 2012-01-04
 *	作者：不羁虫  2012-01-04
 *百度空间： http://www.bujichong.com/
 *邮件地址：bujichong@163.com
 */
!function(a){a.fn.extend({soColorPacker:function(o){function e(){for(var o=a('<div class="colorPackerBox"></div>'),e=["FF","CC","99","66","33","00"],r="",s=0;s<6;s++){r+='<div class="div_cellBox">';for(var t=0;t<6;t++)for(var l=0;l<6;l++){var n=e[s]+e[t]+e[l];r+='<span class="span_colorCell" style="background-color:#'+n+'" rel="#'+n+'"></span>'}r+="</div>"}return r+='<div class="overShowbox"><span class="span_overBg"></span><span class="span_overValue"></span><span class="span_close">关闭</span></div>',o.append(r),o}return o=a.extend({changeTarget:null,textChange:!0,colorChange:1,selfBgChange:!1,size:2,x:0,y:20,styleClass:null,callback:function(){}},o||{}),this.each(function(){var r;a.data(a(this).get(0),"colorPackSa",{hasColorPacker:!1}),a(this).bind("focus click",function(s){var t=a(s.target);if(0==a.data(t.get(0),"colorPackSa").hasColorPacker){a.data(t.get(0),"colorPackSa",{hasColorPacker:!0}),r=e(),a("body").append(r),a.fn.bgIframe&&a(r).bgiframe(),o.styleClass&&a(r).addClass(o.styleClass),1==o.size&&(a(r).width(162),a(".div_cellBox",r).width(54),a(".span_colorCell",r).css({width:"8px",height:"8px"})),3==o.size&&(a(r).width(270),a(".div_cellBox",r).width(90),a(".span_colorCell",r).css({width:"14px",height:"14px"}));var l=t.findPosition(),n=(parseInt(o.x)?parseInt(o.x):0)+l[0],c=(parseInt(o.y)?parseInt(o.y):0)+l[1];a(r).css({position:"absolute",left:n,top:c});var i;if(i=o.changeTarget?a(o.changeTarget):t,0==i.val().indexOf("#")){var u=i.val();a(".span_overBg",r).css("backgroundColor",u),a(".span_overValue",r).text(u)}a(".span_colorCell",r).bind("click",function(){var e=a(this).attr("rel");1==o.colorChange&&i.css("color",e),2==o.colorChange&&i.css("backgroundColor",e),o.selfBgChange&&t.css("backgroundColor",e),o.textChange&&(i.is("input")&&"text"==i.attr("type")?i.val(e):i.text(e)),o.callback({color:e}),e=null,r.remove(),r=null,a.data(t.get(0),"colorPackSa",{hasColorPacker:!1})}).bind("mouseover",function(){var o=a(this).attr("rel");a(".span_overBg",r).css("backgroundColor",o),a(".span_overValue",r).text(o),o=null}),a(".span_close",r).bind("click",function(){r.remove(),r=null,a.data(t.get(0),"colorPackSa",{hasColorPacker:!1})})}}).blur(function(o){var e=a(o.target);setTimeout(function(){r&&(r.remove(),r=null,a.data(e.get(0),"colorPackSa",{hasColorPacker:!1}))},400)})})},findPosition:function(){var o=a(this).get(0),e=curtop=0;if(o.offsetParent){do{e+=o.offsetLeft,curtop+=o.offsetTop}while(o=o.offsetParent);return[e,curtop]}return!1}})}(jQuery);
